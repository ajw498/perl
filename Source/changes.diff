diff -ur perl-5.8.6.orig/ext/Errno/Errno_pm.PL perl-5.8.6/ext/Errno/Errno_pm.PL
--- perl-5.8.6.orig/ext/Errno/Errno_pm.PL	2004-11-01 14:31:59.000000000 +0000
+++ perl-5.8.6/ext/Errno/Errno_pm.PL	2005-03-12 15:32:50.000000000 +0000
@@ -111,7 +111,8 @@
 	# no #file or #line directives
 	my $linux_errno_h = -e '/usr/include/errno.h' ?
 	    '/usr/include/errno.h' : '/usr/local/include/errno.h';
-	$file{$linux_errno_h} = 1;
+#	$file{$linux_errno_h} = 1;
+	$file{"/home/riscos/cross/include/unixlib/errno.h"} = 1;
     } elsif ($^O eq 'MacOS') {
 	# note that we are only getting the GUSI errno's here ...
 	# we might miss out on compiler-specific ones
diff -ur perl-5.8.6.orig/hv.c perl-5.8.6/hv.c
--- perl-5.8.6.orig/hv.c	2004-11-17 12:52:08.000000000 +0000
+++ perl-5.8.6/hv.c	2005-03-22 21:46:43.000000000 +0000
@@ -1742,7 +1742,7 @@
 	xhv->xhv_eiter = Null(HE*); /* HvEITER(hv) = Null(HE*) */
 	return Null(HE*);
     }
-#ifdef DYNAMIC_ENV_FETCH  /* set up %ENV for iteration */
+#ifdef DYNAMIC_ENV_FETCH2  /* set up %ENV for iteration */
     if (!entry && SvRMAGICAL((SV*)hv) && mg_find((SV*)hv, PERL_MAGIC_env))
 	prime_env_iter();
 #endif
diff -ur perl-5.8.6.orig/util.c perl-5.8.6/util.c
--- perl-5.8.6.orig/util.c	2004-11-23 15:17:00.000000000 +0000
+++ perl-5.8.6/util.c	2005-03-22 22:36:29.000000000 +0000
@@ -1422,7 +1422,7 @@
     my_setenv_format(environ[i], nam, nlen, val, vlen);
     } else {
 # endif
-#   if defined(__CYGWIN__) || defined( EPOC)
+#   if defined(__CYGWIN__) || defined( EPOC) || defined(__riscos__)
     setenv(nam, val, 1);
 #   else
     char *new_env;
